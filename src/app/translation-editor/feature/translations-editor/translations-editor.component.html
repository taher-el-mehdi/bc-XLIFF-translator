<div class="flex flex-col h-screen bg-background text-foreground overflow-hidden">
    <!-- Header -->
    @if (fileName()) {
    <header class="flex-none border-b px-6 py-4 flex justify-between items-center bg-background z-50">
        <div class="flex items-center gap-4">
            <img src="./assets/language.svg" alt="Language" class="w-6 h-6">
            <div class="flex flex-col gap-0">
                @if (fileName()) {
                <h1 class="text-lg font-bold tracking-tight text-foreground leading-none">{{ fileName() }}</h1>
                <div class="flex items-center gap-2 text-xs text-muted-foreground mt-1">
                    <span
                        class="uppercase font-mono bg-muted px-1.5 py-0.5 rounded text-[10px] tracking-wider font-medium">{{
                        documentFormat() }}</span>
                        @if (sourceLang() || targetLang()) {
                            <span>{{ sourceLang() || '?' }}</span>
                            <span class="text-[10px]">➜</span>
                            <span>{{ targetLang() || '?' }}</span>
                        }                    
                </div>
                }
            </div>
        </div>


        <div class="flex items-center gap-6">
            <!-- Stats -->
            <div class="flex items-center gap-6">
                <div class="flex gap-4 text-sm">
                    <div class="flex flex-col items-center">
                        <span
                            class="text-muted-foreground text-[10px] uppercase font-bold tracking-wider mb-0.5">Total</span>
                        <span class="font-bold text-foreground">{{ stats().total }}</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span
                            class="text-muted-foreground text-[10px] uppercase font-bold tracking-wider mb-0.5">Translated</span>
                        <span class="font-bold text-green-600 dark:text-green-400">{{ stats().translated }}</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span
                            class="text-muted-foreground text-[10px] uppercase font-bold tracking-wider mb-0.5">Missing</span>
                        <span class="font-bold text-orange-600 dark:text-orange-400">{{ stats().missing }}</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <span
                            class="text-muted-foreground text-[10px] uppercase font-bold tracking-wider mb-0.5">Changed</span>
                        <span class="font-bold text-blue-600 dark:text-blue-400">{{ stats().changed }}</span>
                    </div>
                </div>

                <!-- Progress -->
                <div class="flex flex-col items-end min-w-[80px]">
                    <div class="flex items-baseline gap-1 mb-1">
                        <span class="text-xl font-bold tracking-tight">{{ (stats().translated / stats().total) * 100 |
                            number:'1.0-0' }}</span>
                        <span class="text-xs font-medium text-muted-foreground">%</span>
                    </div>
                    <div class="h-1.5 w-full bg-muted rounded-full overflow-hidden">
                        <div class="h-full bg-primary transition-all duration-500 ease-out"
                            [style.width.%]="(stats().translated / stats().total) * 100"></div>
                    </div>
                </div>
            </div>

            <!-- Separator -->
            <div class="h-8 w-px bg-border"></div>

            <!-- Buttons -->
            <div class="flex gap-2 relative">
                <!-- Backdrop -->
                @if (exportDropdownOpen()) {
                <div class="fixed inset-0 z-60" tabindex="0" (click)="closeExportDropdown()" (keypress)="closeExportDropdown()"></div>
                }

                <div class="relative z-70 flex items-center">
                    <button (click)="exportFile()"
                        class="inline-flex items-baseline justify-center gap-2 rounded-l-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2 border-r border-primary-foreground/20">
                        Export
                    </button>
                    <button (click)="toggleExportDropdown()"
                        class="inline-flex items-center justify-center rounded-r-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-2 py-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="h-4 w-4">
                            <path d="m6 9 6 6 6-6" />
                        </svg>
                    </button>

                    @if (exportDropdownOpen()) {
                    <div
                        class="absolute right-0 top-full mt-1 w-[320px] rounded-md border bg-popover text-popover-foreground shadow-lg animate-in fade-in-0 zoom-in-95 p-4 space-y-4">
                        <!-- Filename Section -->
                        <div class="space-y-2">
                            <label
                                class="text-[10px] font-bold text-muted-foreground uppercase tracking-widest"
                                for="exportFilename">Filename</label>
                            <div class="space-y-1">
                                <input id="exportFilename" type="text" [value]="exportFilename()" (input)="onExportFilenameChange($event)"
                                    class="flex h-8 w-full rounded-md border border-input bg-background px-3 py-1 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"
                                    placeholder="Filename..." />
                                <div class="flex items-center gap-2">
                                    <button (click)="toggleIncludeLocaleSuffix()" [disabled]="!targetLang()"
                                        [class.opacity-50]="!targetLang()" [class.cursor-not-allowed]="!targetLang()"
                                        class="flex items-center gap-2 text-[10px] text-muted-foreground hover:text-foreground transition-colors">
                                        <div class="w-3 h-3 rounded border flex items-center justify-center"
                                            [class.bg-primary]="includeLocaleSuffix() && targetLang()"
                                            [class.border-primary]="includeLocaleSuffix() && targetLang()"
                                            [class.bg-muted]="!targetLang()">
                                            @if (includeLocaleSuffix() && targetLang()) {
                                            <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="text-primary-foreground">
                                                <polyline points="20 6 9 17 4 12" />
                                            </svg>
                                            }
                                        </div>
                                        <span>Include locale suffix</span>
                                        @if (targetLang()) {
                                        <span class="text-primary font-bold">({{ targetLang() }})</span>
                                        } @else {
                                        <span class="italic">(No target language)</span>
                                        }
                                    </button>
                                </div>
                            </div>
                            <div class="bg-muted/50 rounded p-2 border border-dashed">
                                <div class="text-[10px] text-muted-foreground uppercase font-medium mb-1">Preview</div>
                                <div class="text-xs font-mono truncate text-foreground">{{ exportFilenamePreview() }}
                                </div>
                            </div>
                        </div>

                        <!-- Format Section -->
                        <fieldset class="space-y-2">
                            <legend
                                class="text-[10px] font-bold text-muted-foreground uppercase tracking-widest">Format</legend>
                            <div class="grid grid-cols-2 gap-1">
                                @for (format of supportedExportFormats(); track $index) {
                                <button (click)="selectExportFormat(format)"
                                    class="flex items-center justify-center rounded-sm px-2 py-1.5 text-xs border transition-colors hover:bg-accent"
                                    [class.bg-accent]="selectedExport() === format"
                                    [class.border-primary]="selectedExport() === format">
                                    @if (format.type === 'xliff') {
                                    XLIFF
                                    } @else if (format.type === 'json') {
                                    @if (format.jsonFormat === 'flat') { JSON (Flat) }
                                    @else if (format.jsonFormat === 'nested') { JSON (Nested) }
                                    @else if (format.jsonFormat === 'angular') { JSON (Angular) }
                                    }
                                </button>
                                }
                            </div>
                        </fieldset>

                        <!-- Options Section -->
                        <div class="pt-2 border-t">
                            <button (click)="exportFile()"
                                class="w-full inline-flex items-center justify-center rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4">
                                Download File
                            </button>
                        </div>
                    </div>
                    }
                </div>

                <button (click)="reset()"
                    class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-destructive hover:text-destructive-foreground h-9 px-4 py-2">
                    Close
                </button>
            </div>
        </div>
    </header>
    }

    <!-- Main Content Area -->
    <div class="flex-1 flex overflow-hidden">
        @if (!fileName()) {
        <app-landing-screen class="flex w-full" (fileSelected)="onFileSelected($event)" />
        }
        @else {
        <!-- Left Pane: Table & Toolbar -->
        <div class="flex-1 flex flex-col min-w-0">


            <!-- Toolbar -->
            <div class="flex-none pt-4 px-4 flex items-center justify-between gap-4">
                <div class="flex items-center gap-2">
                    <!-- Search -->
                    <div class="relative w-72">
                        <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                            <svg class="w-4 h-4 text-muted-foreground" aria-hidden="true"
                                xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                    stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z" />
                            </svg>
                        </div>
                        <input #searchInput type="text" [value]="filterQuery()" (input)="onSearchInput($event)"
                            (keydown.escape)="searchInput.blur()" (keydown.enter)="onSearchEnter($event)"
                            (keydown.arrowdown)="onSearchEnter($event)"
                            class="flex h-9 w-full rounded-md border border-input bg-background px-3 ps-10 py-1 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 pr-10"
                            placeholder="Search..." />
                        <kbd
                            class="pointer-events-none absolute right-1.5 top-1.5 hidden h-6 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100 sm:flex">
                            <span class="text-sm">⌘</span>K
                        </kbd>
                    </div>

                    <!-- Filter Dropdown -->
                    <div class="flex items-center gap-2 relative">
                        <!-- Backdrop -->
                        @if (dropdownOpen()) {
                        <div class="fixed inset-0 z-20" tabindex="0" (click)="closeDropdown()" (keypress)="closeDropdown()"></div>
                        }

                        <div class="relative z-30">
                            <button (click)="toggleDropdown()"
                                class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-3 gap-2"
                                title="Filter units">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3" />
                                </svg>
                                <span class="flex items-baseline gap-1">
                                    <span>
                                        @switch (filterStatus()) {
                                        @case ('all') { All }
                                        @case ('translated') { Translated }
                                        @case ('missing') { Missing }
                                        @case ('changed') { Changed }
                                        }
                                    </span>
                                    <span class="text-[10px] text-muted-foreground tabular-nums">
                                        @switch (filterStatus()) {
                                        @case ('all') { ({{ stats().total }}) }
                                        @case ('translated') { ({{ stats().translated }}) }
                                        @case ('missing') { ({{ stats().missing }}) }
                                        @case ('changed') { ({{ stats().changed }}) }
                                        }
                                    </span>
                                </span>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="h-3 w-3 opacity-50 ml-1">
                                    <path d="m6 9 6 6 6-6" />
                                </svg>
                            </button>

                            @if (dropdownOpen()) {
                            <div
                                class="absolute left-0 top-full mt-1 w-[200px] rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95">
                                <div class="p-1">
                                    <button (click)="setFilter('all')"
                                        class="relative flex w-full cursor-default select-none items-center justify-between rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground"
                                        [class.bg-accent]="filterStatus() === 'all'">
                                        <span>All</span>
                                        <span class="text-xs text-muted-foreground tabular-nums">{{ stats().total
                                            }}</span>
                                    </button>
                                    <button (click)="setFilter('translated')"
                                        class="relative flex w-full cursor-default select-none items-center justify-between rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground"
                                        [class.bg-accent]="filterStatus() === 'translated'">
                                        <span>Translated</span>
                                        <span class="text-xs text-muted-foreground tabular-nums">{{
                                            stats().translated
                                            }}</span>
                                    </button>
                                    <button (click)="setFilter('missing')"
                                        class="relative flex w-full cursor-default select-none items-center justify-between rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground"
                                        [class.bg-accent]="filterStatus() === 'missing'">
                                        <span>Missing</span>
                                        <span class="text-xs text-muted-foreground tabular-nums">{{ stats().missing
                                            }}</span>
                                    </button>
                                    <button (click)="setFilter('changed')"
                                        class="relative flex w-full cursor-default select-none items-center justify-between rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground"
                                        [class.bg-accent]="filterStatus() === 'changed'">
                                        <span>Changed</span>
                                        <span class="text-xs text-muted-foreground tabular-nums">{{ stats().changed
                                            }}</span>
                                    </button>
                                </div>
                            </div>
                            }
                        </div>
                    </div>
                </div>

                <!-- Right Toolbar Actions -->
                <div class="flex items-center gap-2">

                    <!-- Unified View Dropdown -->
                    <div class="flex items-center gap-2 relative">
                        <!-- Backdrop -->
                        @if (viewSettingsOpen()) {
                        <div class="fixed inset-0 z-20" tabindex="0" (click)="closeViewSettings()" (keypress)="closeViewSettings()"></div>
                        }

                        <div class="relative z-30">
                            <button (click)="toggleViewSettings()"
                                class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-3 gap-2"
                                title="View Settings">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M3 3h18v18H3z" />
                                    <path d="M9 3v18" />
                                    <path d="M3 9h18" />
                                </svg>
                                <span>View</span>
                            </button>

                            @if (viewSettingsOpen()) {
                            <div
                                class="absolute right-0 top-full mt-1 w-[220px] rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95">
                                <div class="p-2 space-y-3">
                                    <!-- View Density -->
                                    <div class="space-y-1.5">
                                        <div
                                            class="px-2 text-[10px] uppercase font-bold tracking-wider text-muted-foreground/70">
                                            Density
                                        </div>
                                        <div class="flex items-center rounded-md border bg-muted p-0.5 h-8">
                                            <button (click)="viewMode.set('compact')"
                                                [class.bg-background]="viewMode() === 'compact'"
                                                [class.shadow-sm]="viewMode() === 'compact'"
                                                [class.text-foreground]="viewMode() === 'compact'"
                                                [class.text-muted-foreground]="viewMode() !== 'compact'"
                                                class="flex-1 inline-flex items-center justify-center rounded-sm px-2 text-xs font-medium transition-all focus-visible:outline-none h-full">
                                                Compact
                                            </button>
                                            <button (click)="viewMode.set('spacious')"
                                                [class.bg-background]="viewMode() === 'spacious'"
                                                [class.shadow-sm]="viewMode() === 'spacious'"
                                                [class.text-foreground]="viewMode() === 'spacious'"
                                                [class.text-muted-foreground]="viewMode() !== 'spacious'"
                                                class="flex-1 inline-flex items-center justify-center rounded-sm px-2 text-xs font-medium transition-all focus-visible:outline-none h-full">
                                                Spacious
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Separator Alternative -->
                                    <div class="h-px bg-border -mx-2"></div>

                                    <!-- Column Visibility -->
                                    <div class="space-y-0.5">
                                        <div
                                            class="px-2 pb-1 text-[10px] uppercase font-bold tracking-wider text-muted-foreground/70">
                                            Columns
                                        </div>
                                        <button (click)="showIdColumn.set(!showIdColumn())"
                                            class="relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground">
                                            <span class="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
                                                @if (showIdColumn()) {
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                                                    class="h-3.5 w-3.5">
                                                    <polyline points="20 6 9 17 4 12" />
                                                </svg>
                                                }
                                            </span>
                                            <span>ID</span>
                                        </button>
                                        @if (features().hasSource) {
                                        <button (click)="showSourceColumn.set(!showSourceColumn())"
                                            class="relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground">
                                            <span class="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
                                                @if (showSourceColumn()) {
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                                                    class="h-3.5 w-3.5">
                                                    <polyline points="20 6 9 17 4 12" />
                                                </svg>
                                                }
                                            </span>
                                            <span>Source</span>
                                        </button>
                                        }
                                        <button (click)="showTargetColumn.set(!showTargetColumn())"
                                            class="relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground">
                                            <span class="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
                                                @if (showTargetColumn()) {
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                                                    class="h-3.5 w-3.5">
                                                    <polyline points="20 6 9 17 4 12" />
                                                </svg>
                                                }
                                            </span>
                                            <span>Target</span>
                                        </button>
                                        @if (features().hasNotes) {
                                        <button (click)="showNotesColumn.set(!showNotesColumn())"
                                            class="relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground">
                                            <span class="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
                                                @if (showNotesColumn()) {
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                                                    class="h-3.5 w-3.5">
                                                    <polyline points="20 6 9 17 4 12" />
                                                </svg>
                                                }
                                            </span>
                                            <span>Notes</span>
                                        </button>
                                        }
                                    </div>
                                </div>
                            </div>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <!-- Table Content (Scrollable) -->
            <div class="flex-1 overflow-auto p-4 pb-0">
                <div class="rounded-md border">
                    <app-translation-table [units]="paginatedUnits()" [viewMode]="viewMode()"
                        [showIdColumn]="showIdColumn()" [showSourceColumn]="showSourceColumn()"
                        [showTargetColumn]="showTargetColumn()" [showNotesColumn]="showNotesColumn()"
                        [selectedId]="selectedUnitId()" (unitSelect)="selectUnit($event, true)" />
                </div>
            </div>

            <!-- Pagination Footer (Sticky) -->
            <div class="flex-none p-4 bg-background border-t">
                <div class="flex items-center justify-between gap-4">
                    <div class="flex items-center gap-6">
                        <!-- Navigation -->
                        <div class="flex items-center gap-2">
                            <div class="flex items-center gap-1">
                                <kbd
                                    class="pointer-events-none h-5 select-none items-center justify-center rounded border bg-muted px-1.5 font-mono text-xs font-medium text-muted-foreground flex min-w-[20px]">↑</kbd>
                                <kbd
                                    class="pointer-events-none h-5 select-none items-center justify-center rounded border bg-muted px-1.5 font-mono text-xs font-medium text-muted-foreground flex min-w-[20px]">↓</kbd>
                            </div>
                            <span
                                class="text-[10px] text-muted-foreground font-bold uppercase tracking-wider">Select</span>
                        </div>

                        <!-- Pagination -->
                        <div class="flex items-center gap-2 border-l pl-4">
                            <div class="flex items-center gap-1">
                                <kbd
                                    class="pointer-events-none h-5 select-none items-center justify-center rounded border bg-muted px-1.5 font-mono text-xs font-medium text-muted-foreground flex min-w-[20px]">←</kbd>
                                <kbd
                                    class="pointer-events-none h-5 select-none items-center justify-center rounded border bg-muted px-1.5 font-mono text-xs font-medium text-muted-foreground flex min-w-[20px]">→</kbd>
                            </div>
                            <span
                                class="text-[10px] text-muted-foreground font-bold uppercase tracking-wider">Page</span>
                        </div>

                        <!-- Actions -->
                        <div class="flex items-center gap-2 border-l pl-4">
                            <div class="flex items-center gap-1">
                                <kbd
                                    class="pointer-events-none h-5 select-none items-center justify-center rounded border bg-muted px-1.5 font-mono text-xs font-medium text-muted-foreground flex min-w-[40px]">Enter</kbd>
                            </div>
                            <span
                                class="text-[10px] text-muted-foreground font-bold uppercase tracking-wider">Edit</span>
                        </div>

                        <div class="flex items-center gap-2 border-l pl-4">
                            <div class="flex items-center gap-1">
                                <kbd
                                    class="pointer-events-none h-5 select-none items-center justify-center rounded border bg-muted px-1.5 font-mono text-xs font-medium text-muted-foreground flex min-w-[20px]">Esc</kbd>
                            </div>
                            <span
                                class="text-[10px] text-muted-foreground font-bold uppercase tracking-wider">Back</span>
                        </div>
                    </div>

                    <app-pagination [pageIndex]="pageIndex()" [pageSize]="pageSize()" [total]="totalItems()"
                        (pageChange)="changePage($event)" />
                </div>
            </div>
        </div>

        <!-- Right Pane: Detail View -->
        @if (selectedUnit()) {
        <aside class="w-[400px] flex-none shadow-xl z-30">
            <app-translation-detail [unit]="selectedUnit()!" [showSource]="features().hasSource"
                [showNotes]="features().hasNotes" (save)="onUnitUpdate($event)" (closed)="selectedUnitId.set(null)" />
        </aside>
        }
        }
    </div>
</div>